"use strict";
exports.__esModule = true;
exports.generateInvoiceHTML = void 0;
var VAT_RATE = 0.135;
function generateInvoiceHTML(order, tickets) {
    var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o;
    var total = Number((_a = order.totalAmount) !== null && _a !== void 0 ? _a : 0) / 100;
    var serviceFee = Number((_b = order.serviceFee) !== null && _b !== void 0 ? _b : 0) / 100;
    var paymentMethod = (_c = order.paymentMethod) !== null && _c !== void 0 ? _c : "";
    var vatAmount = total * VAT_RATE;
    var netAmount = total - vatAmount;
    var formattedDate = new Date((_d = order.createdAt) !== null && _d !== void 0 ? _d : (_e = order.event) === null || _e === void 0 ? void 0 : _e.date).toLocaleString("en-GB", {
        timeZone: "Europe/Helsinki"
    });
    return "\n  <html>\n    <body style=\"margin:0; padding:0; background:#0d0d0d; font-family: 'Segoe UI', sans-serif; color:#f5f5f5;\">\n\n      <div style=\"max-width:850px; margin:40px auto; background:#111; border-radius:14px; overflow:hidden; box-shadow:0 0 40px rgba(0,0,0,0.6);\">\n\n        <!-- GOLD HEADER -->\n        <div style=\"\n          background: linear-gradient(135deg, #d4af37, #b8860b);\n          padding: 28px 32px;\n          display:flex;\n          justify-content:space-between;\n          align-items:center;\n        \">\n          <div style=\"display:flex; align-items:center; gap:16px;\">\n            <img \n              src=\"file:///" + process.cwd().replace(/\\/g, "/") + "/public/logo.png\"\n              style=\"height:70px;\"\n            />\n            <div style=\"font-size:26px; font-weight:700; letter-spacing:1px; color:#000;\">\n              TAPROBANE CINEMA\n            </div>\n          </div>\n\n          <div style=\"text-align:right; color:#000;\">\n            <div style=\"font-size:22px; font-weight:700;\">INVOICE</div>\n            <div style=\"font-size:13px;\">Receipt No: " + order.id + "</div>\n            <div style=\"font-size:13px;\">Order Time: " + formattedDate + "</div>\n          </div>\n        </div>\n\n        <!-- BODY CONTENT -->\n        <div style=\"padding:32px;\">\n\n          <!-- CUSTOMER + SELLER -->\n          <div style=\"display:flex; justify-content:space-between; gap:40px; flex-wrap:wrap; margin-bottom:32px;\">\n            <div style=\"flex:1; min-width:260px;\">\n              <div style=\"font-size:15px; font-weight:600; color:#d4af37; margin-bottom:6px;\">Customer</div>\n              <div style=\"font-size:14px; line-height:1.6;\">\n                " + ((_f = order.name) !== null && _f !== void 0 ? _f : "") + "<br/>\n                " + ((_g = order.email) !== null && _g !== void 0 ? _g : "") + "<br/>\n                " + ((_h = order.contactNo) !== null && _h !== void 0 ? _h : "") + "\n              </div>\n            </div>\n\n            <div style=\"flex:1; min-width:260px;\">\n              <div style=\"font-size:15px; font-weight:600; color:#d4af37; margin-bottom:6px;\">Seller</div>\n              <div style=\"font-size:14px; line-height:1.6;\">\n                Taprobane Entertainment Oy<br/>\n                Business ID: 1234567-8<br/>\n                info@taprobane.fi<br/>\n                www.taprobane.fi\n              </div>\n            </div>\n          </div>\n\n          <!-- EVENT BLOCK -->\n          <div style=\"\n            background:#1a1a1a;\n            border:1px solid #333;\n            padding:20px;\n            border-radius:10px;\n            margin-bottom:32px;\n          \">\n            <div style=\"font-size:15px; font-weight:600; color:#d4af37; margin-bottom:6px;\">Event</div>\n            <div style=\"font-size:14px; line-height:1.6;\">\n              " + ((_k = (_j = order.event) === null || _j === void 0 ? void 0 : _j.title) !== null && _k !== void 0 ? _k : "") + "<br/>\n              " + ((_m = (_l = order.event) === null || _l === void 0 ? void 0 : _l.venue) !== null && _m !== void 0 ? _m : "") + "<br/>\n              " + (((_o = order.event) === null || _o === void 0 ? void 0 : _o.date) ? new Date(order.event.date).toLocaleString("en-GB", {
        timeZone: "Europe/Helsinki"
    })
        : "") + "\n            </div>\n          </div>\n\n          <!-- TICKETS TABLE -->\n          <table style=\"width:100%; border-collapse:collapse; margin-bottom:32px; font-size:14px;\">\n            <thead>\n              <tr style=\"background:#222;\">\n                <th style=\"padding:12px; text-align:left; color:#d4af37;\">Product</th>\n                <th style=\"padding:12px; text-align:center; color:#d4af37;\">Qty</th>\n                <th style=\"padding:12px; text-align:right; color:#d4af37;\">Price excl. VAT</th>\n                <th style=\"padding:12px; text-align:right; color:#d4af37;\">VAT</th>\n                <th style=\"padding:12px; text-align:right; color:#d4af37;\">Total</th>\n              </tr>\n            </thead>\n            <tbody>\n              " + tickets
        .map(function (t, index) {
        var price = total / tickets.length;
        var itemVat = price * VAT_RATE;
        var itemNet = price - itemVat;
        var bg = index % 2 === 0 ? "#161616" : "#1e1e1e";
        return "\n                  <tr style=\"background:" + bg + ";\">\n                    <td style=\"padding:12px; color:#f5f5f5;\">\n                      Ticket " + t.category + " " + t.tier + "<br/>\n                      <span style=\"font-size:12px; color:#999;\">Code: " + t.code + "</span>\n                    </td>\n                    <td style=\"padding:12px; text-align:center;\">1</td>\n                    <td style=\"padding:12px; text-align:right;\">" + itemNet.toFixed(2) + " \u20AC</td>\n                    <td style=\"padding:12px; text-align:right;\">" + itemVat.toFixed(2) + " \u20AC</td>\n                    <td style=\"padding:12px; text-align:right;\">" + price.toFixed(2) + " \u20AC</td>\n                  </tr>";
    })
        .join("") + "\n            </tbody>\n          </table>\n\n          <!-- PAYMENT SUMMARY -->\n          <div style=\"display:flex; justify-content:flex-end;\">\n            <table style=\"width:320px; font-size:14px;\">\n              <tr>\n                <td style=\"padding:6px 0; color:#ccc;\">Total excl. VAT:</td>\n                <td style=\"padding:6px 0; text-align:right; color:#fff;\">" + netAmount.toFixed(2) + " \u20AC</td>\n              </tr>\n              <tr>\n                <td style=\"padding:6px 0; color:#ccc;\">VAT 13.5%:</td>\n                <td style=\"padding:6px 0; text-align:right; color:#fff;\">" + vatAmount.toFixed(2) + " \u20AC</td>\n              </tr>\n              <tr>\n                <td style=\"padding:6px 0; color:#ccc;\">Service fee:</td>\n                <td style=\"padding:6px 0; text-align:right; color:#fff;\">" + serviceFee.toFixed(2) + " \u20AC</td>\n              </tr>\n              <tr>\n                <td style=\"padding:10px 0; font-weight:700; color:#d4af37;\">Total payable:</td>\n                <td style=\"padding:10px 0; text-align:right; font-weight:700; color:#d4af37;\">" + total.toFixed(2) + " \u20AC</td>\n              </tr>\n            </table>\n          </div>\n\n          <!-- FOOTER -->\n          <div style=\"margin-top:40px; text-align:center; font-size:12px; color:#777;\">\n            This is an automatically generated invoice for your ticket purchase.<br/>\n            Taprobane Entertainment Oy \u00B7 Business ID: 1234567-8 \u00B7 Messukeskus, Helsinki\n          </div>\n\n        </div>\n      </div>\n\n    </body>\n  </html>\n  ";
}
exports.generateInvoiceHTML = generateInvoiceHTML;
